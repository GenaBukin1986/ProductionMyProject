{% extends 'shopapp/base.html' %}
{% load l10n %}

{% block title %}
  –ú–æ–∏ –∑–∞–∫–∞–∑—ã
{% endblock %}

{% block body %}
  <header class="page-header">
    <h1 class="page-title">–ú–æ–∏ –∑–∞–∫–∞–∑—ã</h1>
    {% if object_list %}
      <p class="page-subtitle">–í—Å–µ–≥–æ: {{ object_list|length }} –∑–∞–∫–∞–∑{% if object_list|length == 1 %}{{ "" }}{% elif object_list|length > 1 and object_list|length < 5 %}–∞{% else %}–æ–≤{% endif %}</p>
    {% endif %}
  </header>

  {% if object_list %}
    <div class="orders-grid">
      {% for order in object_list %}
        <article class="order-card card">
          <div class="order-card-header">
            <h2 class="order-number">
              <a href="{% url 'shopapp:order_details' pk=order.pk %}" class="order-link">
                –ó–∞–∫–∞–∑ ‚Ññ{{ order.pk }}
              </a>
            </h2>
            {% if order.created_at %}
              <time class="order-date" datetime="{{ order.created_at|date:'c' }}">
                {{ order.created_at|date:"d E Y" }}
              </time>
            {% endif %}
          </div>

          <div class="order-card-body">
            <p class="order-customer">
              {% if order.user %}
                –ö–ª–∏–µ–Ω—Ç: <strong>{% firstof order.user.get_full_name order.user.username %}</strong>
              {% else %}
                <span class="text-muted">–ì–æ—Å—Ç—å</span>
              {% endif %}
            </p>

            <div class="order-summary">
              <div>
                <strong>{{ order.products.count }}</strong>
                —Ç–æ–≤–∞—Ä{% if order.products.count == 1 %}{{ "" }}{% elif order.products.count < 5 %}–∞{% else %}–æ–≤{% endif %}
              </div>
              {% if order.promocode %}
                <code class="tag promo-tag">{{ order.promocode|upper }}</code>
              {% endif %}
            </div>

            {% if order.delivery_address %}
              <p class="order-address">
                üìç {{ order.delivery_address|truncatechars:60 }}
              </p>
            {% endif %}
          </div>

          <div class="order-card-footer">
            <a href="{% url 'shopapp:order_details' pk=order.pk %}" class="btn btn-outline">
              –ü–æ–¥—Ä–æ–±–Ω–µ–µ &rarr;
            </a>
          </div>
        </article>
      {% endfor %}
    </div>
  {% else %}
    <div class="empty-state">
      <h2 class="empty-title">–ó–∞–∫–∞–∑–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h2>
      <p class="empty-text">–û—Ñ–æ—Ä–º–∏—Ç–µ –ø–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑ ‚Äî –∏ –æ–Ω –ø–æ—è–≤–∏—Ç—Å—è –∑–¥–µ—Å—å.</p>
      <a href="{% url 'shopapp:products_list' %}" class="btn btn-primary">–ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞—Ç–∞–ª–æ–≥</a>
    </div>
  {% endif %}
{% endblock %}